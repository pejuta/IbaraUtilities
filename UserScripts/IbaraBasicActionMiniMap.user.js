// ==UserScript==
// @name         IbaraBasicActionMiniMap
// @namespace    https://twitter.com/11powder
// @version      0.1.12
// @description  マップ上にあなたの現在位置を表示します。
// @include      /^http:\/\/lisge\.com\/ib\/act_main\.php.*?$/
// @updateURL    https://pejuta.github.io/IbaraUtilities/UserScripts/IbaraBasicActionMiniMap.user.js
// @downloadURL  https://pejuta.github.io/IbaraUtilities/UserScripts/IbaraBasicActionMiniMap.user.js
// @grant        none
// ==/UserScript==
!function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=6)}([function(t,n){t.exports='<div id="MiniMapCnt">\r\n    <table id="MiniMap">\r\n        <tbody>\r\n        <tr>\r\n            <td><a href="http://lisge.com/ib/k/now/map1.html" target="_blank"><img src="./p/hazamap1.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map2.html" target="_blank"><img src="./p/hazamap2.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map3.html" target="_blank"><img src="./p/hazamap3.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map4.html" target="_blank"><img src="./p/hazamap4.png"></a></td>\r\n        </tr>\r\n        <tr>\r\n            <td><a href="http://lisge.com/ib/k/now/map5.html" target="_blank"><img src="./p/hazamap5.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map6.html" target="_blank"><img src="./p/hazamap6.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map7.html" target="_blank"><img src="./p/hazamap7.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map8.html" target="_blank"><img src="./p/hazamap8.png"></a></td>\r\n        </tr>\r\n        <tr>\r\n            <td><a href="http://lisge.com/ib/k/now/map9.html" target="_blank"><img src="./p/hazamap9.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map10.html" target="_blank"><img src="./p/hazamap10.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map11.html" target="_blank"><img src="./p/hazamap11.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map12.html" target="_blank"><img src="./p/hazamap12.png"></a></td>\r\n        </tr>\r\n        <tr>\r\n            <td><a href="http://lisge.com/ib/k/now/map13.html" target="_blank"><img src="./p/hazamap13.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map14.html" target="_blank"><img src="./p/hazamap14.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map15.html" target="_blank"><img src="./p/hazamap15.png"></a></td>\r\n            <td><a href="http://lisge.com/ib/k/now/map16.html" target="_blank"><img src="./p/hazamap16.png"></a></td>\r\n        </tr>\r\n        </tbody>\r\n    </table>\r\n    <div id="CntCourse">\r\n        <div class="MapCourse">\r\n            <span class="MapCourseIco"></span>\r\n            <div class="MapCourse">\r\n                <span class="MapCourseIco"></span>\r\n                <div class="MapCourse">\r\n                    <span class="MapCourseIco"></span>\r\n                    <div class="MapCourse">\r\n                        <span class="MapCourseIco"></span>\r\n                        <div class="MapCourse">\r\n                            <span class="MapCourseIco"></span>\r\n                            <div class="MapCourse">\r\n                                <span class="MapCourseIco Goal"></span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div id="MapShadow"></div>\r\n</div>'},function(t,n,e){var r=e(2);"string"==typeof r&&(r=[[t.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};e(4)(r,o);r.locals&&(t.exports=r.locals)},function(t,n,e){(t.exports=e(3)(!1)).push([t.i,'@charset "utf-8";\r\n\r\n#MiniMapCnt {\r\n    width: 325px;\r\n    height: 325px;\r\n    position: relative;\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    line-height: 0;\r\n    background-color: #200000;\r\n}\r\n\r\n#MiniMap {\r\n    position: absolute;\r\n    left: 150px;\r\n    top: 150px;\r\n    border-collapse: collapse; border-spacing: 0;\r\n}\r\n\r\n#MiniMap td, #MiniMap th {\r\n    padding: 0;\r\n}\r\n\r\n#MiniMap img {\r\n    width: 498px;\r\n    height: 498px;\r\n    object-fit: none;\r\n    margin: 1px;\r\n}\r\n\r\n#CntCourse {\r\n    width: 0;\r\n    height: 0;\r\n    position: absolute;\r\n    left: 150px;\r\n    top: 150px;\r\n    font-size: 25px;\r\n    line-height: 100%;\r\n    vertical-align: middle;\r\n}\r\n\r\n.MapCourse {\r\n    width: 25px;\r\n    height: 25px;\r\n    position: absolute;\r\n    top: 0px;\r\n    left: 0px;\r\n    pointer-events: none;\r\n    text-align: center;\r\n}\r\n.MapCourse.Top > .MapCourse {\r\n    top: -25px;\r\n    left: 0px;\r\n}\r\n.MapCourse.Right > .MapCourse {\r\n    top: 0px;\r\n    left: 25px;\r\n}\r\n.MapCourse.Bottom > .MapCourse {\r\n    top: 25px;\r\n    left: 0px;\r\n}\r\n.MapCourse.Left > .MapCourse {\r\n    top: 0px;\r\n    left: -25px;\r\n}\r\n.MapCourse.Final > .MapCourse {\r\n    visibility: hidden;\r\n}\r\n\r\n.MapCourseIco::before, .MapCourseIco::after {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    display: inline-block;\r\n    width: 25px;\r\n    height: 25px;\r\n}\r\n.MapCourseIco.Pause::before {\r\n    content: "\\1F4A4";\r\n    color: transparent;\r\n    text-shadow: 0 0 0 aqua;\r\n    font-family: "Segoe UI Symbol", sans-serif;\r\n}\r\n.MapCourseIco.Step::before {\r\n    content: "\\1F463";\r\n    color: transparent;\r\n    text-shadow: 0 0 0 orange;\r\n    font-family: "Segoe UI Symbol", sans-serif;\r\n}\r\n.Paw .MapCourseIco.Step::before {\r\n    content: "\\1F43E";\r\n}\r\n.MapCourse.Right > .MapCourseIco.Step::before,\r\n.MapCourse.Right > .MapCourseIco.Step::after  {\r\n    transform: rotate(90deg);\r\n}\r\n.MapCourse.Bottom > .MapCourseIco.Step::before,\r\n.MapCourse.Bottom > .MapCourseIco.Step::after {\r\n    transform: rotate(180deg);\r\n}\r\n.MapCourse.Left > .MapCourseIco.Step::before,\r\n.MapCourse.Left > .MapCourseIco.Step::after {\r\n    transform: rotate(270deg);\r\n}\r\n.MapCourseIco.Taxi::before {\r\n    content: "\\1F695";\r\n    color: inherit;\r\n    text-shadow: none;\r\n}\r\n.MapCourseIco.Goal::before {\r\n    content: "\\1F6A9";\r\n    color: inherit;\r\n    text-shadow: none;\r\n}\r\n\r\n.MapCourse.NoVitality > .MapCourseIco.Step::before {\r\n    content: "\\1F463";\r\n    color: transparent;\r\n    text-shadow: 0 0 0 rgb(63, 63, 191);\r\n    font-family: "Segoe UI Symbol", sans-serif;\r\n}\r\n\r\n.MapCourse.Impassable > .MapCourseIco.Step::after {\r\n    content: "\\2716";\r\n    color: transparent;\r\n    text-shadow: 0 0 0 red;\r\n    font-family: "Segoe UI Symbol", sans-serif;\r\n    line-height: 0;\r\n    z-index: 1;\r\n}\r\n\r\n#MapShadow {\r\n    width: 325px;\r\n    height: 325px;\r\n    position: absolute;\r\n    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUUAAAFFAQMAAABBum0eAAAABGdBTUEAALGPC/xhBQAAAAZQTFRFAAAAAAAApWe5zwAAAAJ0Uk5TAHwvIPAvAAAAe0lEQVRo3u3asQmAQAxA0TiBIziKo+lojuIIlhaCgmBxENE+75fHqwN3lzh/tgdJkpXlEdGRJEk2B08kSZJ3W7RNJElWl2tkjSRJ1pVLvDeQJFlRzvFVT5JkOWl+kiSZSncukiRT6Z2WJEk/tiRJ/pf2wUiStBlOkmQmLyN6X7x1dDYTAAAAAElFTkSuQmCC");\r\n    pointer-events: none;\r\n}',""])},function(t,n,e){"use strict";t.exports=function(t){var n=[];return n.toString=function(){return this.map((function(n){var e=function(t,n){var e=t[1]||"",r=t[3];if(!r)return e;if(n&&"function"==typeof btoa){var o=(i=r,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),a=r.sources.map((function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"}));return[e].concat(a).concat([o]).join("\n")}var i;return[e].join("\n")}(n,t);return n[2]?"@media "+n[2]+"{"+e+"}":e})).join("")},n.i=function(t,e){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var a=this[o][0];null!=a&&(r[a]=!0)}for(o=0;o<t.length;o++){var i=t[o];null!=i[0]&&r[i[0]]||(e&&!i[2]?i[2]=e:e&&(i[2]="("+i[2]+") and ("+e+")"),n.push(i))}},n}},function(t,n,e){var r,o,a={},i=(r=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=r.apply(this,arguments)),o}),s=function(t,n){return n?n.querySelector(t):document.querySelector(t)},l=function(t){var n={};return function(t,e){if("function"==typeof t)return t();if(void 0===n[t]){var r=s.call(this,t,e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}n[t]=r}return n[t]}}(),c=null,p=0,u=[],d=e(5);function f(t,n){for(var e=0;e<t.length;e++){var r=t[e],o=a[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(x(r.parts[i],n))}else{var s=[];for(i=0;i<r.parts.length;i++)s.push(x(r.parts[i],n));a[r.id]={id:r.id,refs:1,parts:s}}}}function h(t,n){for(var e=[],r={},o=0;o<t.length;o++){var a=t[o],i=n.base?a[0]+n.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};r[i]?r[i].parts.push(s):e.push(r[i]={id:i,parts:[s]})}return e}function m(t,n){var e=l(t.insertInto);if(!e)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=u[u.length-1];if("top"===t.insertAt)r?r.nextSibling?e.insertBefore(n,r.nextSibling):e.appendChild(n):e.insertBefore(n,e.firstChild),u.push(n);else if("bottom"===t.insertAt)e.appendChild(n);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=l(t.insertAt.before,e);e.insertBefore(n,o)}}function g(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var n=u.indexOf(t);n>=0&&u.splice(n,1)}function v(t){var n=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var r=function(){0;return e.nc}();r&&(t.attrs.nonce=r)}return b(n,t.attrs),m(t,n),n}function b(t,n){Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])}))}function x(t,n){var e,r,o,a;if(n.transform&&t.css){if(!(a="function"==typeof n.transform?n.transform(t.css):n.transform.default(t.css)))return function(){};t.css=a}if(n.singleton){var i=p++;e=c||(c=v(n)),r=C.bind(null,e,i,!1),o=C.bind(null,e,i,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(e=function(t){var n=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",b(n,t.attrs),m(t,n),n}(n),r=A.bind(null,e,n),o=function(){g(e),e.href&&URL.revokeObjectURL(e.href)}):(e=v(n),r=M.bind(null,e),o=function(){g(e)});return r(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;r(t=n)}else o()}}t.exports=function(t,n){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(n=n||{}).attrs="object"==typeof n.attrs?n.attrs:{},n.singleton||"boolean"==typeof n.singleton||(n.singleton=i()),n.insertInto||(n.insertInto="head"),n.insertAt||(n.insertAt="bottom");var e=h(t,n);return f(e,n),function(t){for(var r=[],o=0;o<e.length;o++){var i=e[o];(s=a[i.id]).refs--,r.push(s)}t&&f(h(t,n),n);for(o=0;o<r.length;o++){var s;if(0===(s=r[o]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete a[s.id]}}}};var y,w=(y=[],function(t,n){return y[t]=n,y.filter(Boolean).join("\n")});function C(t,n,e,r){var o=e?"":r.css;if(t.styleSheet)t.styleSheet.cssText=w(n,o);else{var a=document.createTextNode(o),i=t.childNodes;i[n]&&t.removeChild(i[n]),i.length?t.insertBefore(a,i[n]):t.appendChild(a)}}function M(t,n){var e=n.css,r=n.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}function A(t,n,e){var r=e.css,o=e.sourceMap,a=void 0===n.convertToAbsoluteUrls&&o;(n.convertToAbsoluteUrls||a)&&(r=d(r)),o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var i=new Blob([r],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(i),s&&URL.revokeObjectURL(s)}},function(t,n){t.exports=function(t){var n="undefined"!=typeof window&&window.location;if(!n)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var e=n.protocol+"//"+n.host,r=e+n.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,n){var o,a=n.trim().replace(/^"(.*)"$/,(function(t,n){return n})).replace(/^'(.*)'$/,(function(t,n){return n}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?t:(o=0===a.indexOf("//")?a:0===a.indexOf("/")?e+a:r+a.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")}))}},function(t,n,e){"use strict";var r;e.r(n),function(t){t[t.None=0]="None",t[t.Top=1]="Top",t[t.Right=2]="Right",t[t.Bottom=3]="Bottom",t[t.Left=4]="Left"}(r||(r={}));class o{constructor(t,n,e){if("string"==typeof t){if(this.div=t,this.divIndex=o.divIndices[t],void 0===this.divIndex)throw new Error(`"${t}"は不正です。`);this.x=n.charCodeAt(0)-65,this.y=parseInt(e,10)-1}else{if(this.divIndex=t,this.div=o.divNames[t],void 0===this.div)throw new Error(`区番号${t}は不正です。`);this.x=n,this.y=e}}static tryExtractFirst(t){const n=this.divExtractingPattern.exec(t);return n?new o(n[1],n[2],n[3]):null}static tryExtractAll(t){const n=t.match(this.divExtractingAllPattern);return n?n.map(t=>this.parse(t)):null}static parse(t){const n=this.divParsingPattern.exec(t);if(null===n)throw new Error("位置情報テキストが正常に解析できませんでした。");return new o(n[1],n[2],n[3])}static offset(t,n,e){let a,i;if("number"==typeof e)a=n,i=e;else{const t=function(t){let n,e;switch(t){case r.Top:n=0,e=-1;break;case r.Right:n=1,e=0;break;case r.Bottom:n=0,e=1;break;case r.Left:n=-1,e=0;break;default:n=0,e=0}return{x:n,y:e}}(n);a=t.x,i=t.y}let s=t.x+a,l=t.y+i,c=t.divIndex;const p=Math.floor(s/20);if(s<0){if(t.divColumn+p<0)return null;s=s%20+20,c+=p}else if(s>=20){if(t.divColumn+p>3)return null;s%=20,c+=p}const u=Math.floor(l/20);if(l<0){if(t.divRow+u<0)return null;l=l%20+20,c-=4*u}else if(l>=20){if(t.divRow+u>3)return null;l%=20,c+=4*u}return new o(c,s,l)}get divRow(){return Math.floor(this.divIndex/4)}get divColumn(){return this.divIndex%4}offset(t,n){return o.offset(this,t,n)}toString(){return`${this.div}${String.fromCharCode(this.x+65)}-${this.y+1}`}}o.divNames=["チナミ区","ヒノデ区","マガサ区","ミナト区","カミセイ区","ウシ区","リュウジン区","アライ区","オオキタ区","カスミ区","コヌマ区","タニモリ区","シモヨメ区","ウラド区","ツクナミ区","マシカ区"],o.divIndices=o.divNames.reduce((t,n,e)=>(t[n]=e,t),{}),o.divExtractingAllPattern=new RegExp(`(?:^|\\b)(?:${o.divNames.join("|")}) ?(?:[A-Z])-?(?:\\d{1,2})`,"g"),o.divExtractingPattern=new RegExp(`(?:^|\\b)(${o.divNames.join("|")}) ?([A-Z])-?(\\d{1,2})`),o.divParsingPattern=new RegExp(`^(${o.divNames.join("|")}) ?([A-Z])-?(\\d{1,2})(?:（.*?）)?$`);var a=function(t,n,e,r){return new(e||(e=Promise))((function(o,a){function i(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(i,s)}l((r=r.apply(t,n||[])).next())}))};class i{constructor(){throw new Error("NotImplemented")}static load(t){return a(this,void 0,void 0,(function*(){try{return yield(yield fetch(t)).json()}catch(t){return null}}))}}i.jsonUrl="";var s=function(t,n,e,r){return new(e||(e=Promise))((function(o,a){function i(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(i,s)}l((r=r.apply(t,n||[])).next())}))};class l extends o{constructor(t,n,e){if(t instanceof o?super(t.divIndex,t.x,t.y):super(t,n,e),this.type=-1,!l.data)return;const r=l.data[this.div];if(!r)return;const a=r[this.toCoordsString()];a&&(this.type=a.t)}static loadMapData(t){return s(this,void 0,void 0,(function*(){this.data=yield i.load(t)}))}get isPassable(){return-1===this.type||this.type>=3&&this.type<=8}get isCheckpoint(){return 8===this.type}static tryExtractFirst(t){const n=this.divExtractingPattern.exec(t);return n?new l(n[1],n[2],n[3]):null}static tryExtractAll(t){const n=t.match(this.divExtractingAllPattern);return n?n.map(t=>this.parse(t)):null}static parse(t){const n=this.divParsingPattern.exec(t);if(null===n)throw new Error("位置情報テキストが正常に解析できませんでした。");return new l(n[1],n[2],n[3])}static offset(t,n,e){const r=super.offset(t,n,e);return null===r?null:new l(r)}offset(t,n){return l.offset(this,t,n)}toCoordsString(){return String.fromCharCode(this.x+65)+(this.y+1)}}l.data=null;var c,p=e(0),u=e.n(p),d=(e(1),function(t,n,e,r){return new(e||(e=Promise))((function(o,a){function i(t){try{l(r.next(t))}catch(t){a(t)}}function s(t){try{l(r.throw(t))}catch(t){a(t)}}function l(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(i,s)}l((r=r.apply(t,n||[])).next())}))});c=window.jQuery,d(void 0,void 0,void 0,(function*(){function t(){const t=l.tryExtractFirst(c("select[name='dt_taxi']>option:selected").text());return t||e()}const n=c("b.G3").filter((t,n)=>"転送と移動、パーティ結成"===n.innerHTML).next("span.B2").next("span.P2").children("a").first();function e(){return 0===n.length?null:l.parse(n.html())}const r=document.implementation.createHTMLDocument();function o(n){(n||(n=t()))&&c("#MiniMap").css({left:150-25*n.x-500*n.divColumn+"px",top:150-25*n.y-500*n.divRow+"px"})}function a(n){const e=c("#IDO > select[name^=dt_ido]"),r=c(".MapCourse").removeClass("Paw Top Right Bottom Left Final NoVitality Impassable"),o=c(".MapCourseIco").removeClass("Pause Step Taxi");if(32*Math.random()<1&&c(".MapCourse").addClass("Paw"),!n&&!(n=t()))return;let a=0,s=0,l=0;for(let t=0;t<5;t++){const c=e.eq(t).val(),p=o.eq(t),u=r.eq(t),d=parseInt(c,10);switch(d>=1&&d<=4&&a++,c){case"0":p.addClass("Pause");break;case"1":p.addClass("Step"),u.addClass("Top"),l-=1;break;case"2":p.addClass("Step"),u.addClass("Right"),s+=1;break;case"3":p.addClass("Step"),u.addClass("Bottom"),l+=1;break;case"4":p.addClass("Step"),u.addClass("Left"),s-=1;break;case"5":p.addClass("Taxi"),u.addClass("Final"),t=5}null!==i&&a>i&&u.addClass("NoVitality");const f=n.offset(s,l);null!==f&&!f.isPassable&&u.addClass("Impassable")}}let i=null;var s;yield l.loadMapData("https://pejuta.github.io/IbaraUtilities/Files/Data/map.json"),e()&&(c("#IDO").after(u.a),c("select[name='dt_taxi']").on("change",()=>{const n=t();o(n),a(n)}),c("select[name^=dt_ido]").on("change",()=>a()),o(),a(),i=yield function(){return d(this,void 0,void 0,(function*(){const t=function(){const t=/IBR_KEY=.+?_(\d+)(?:;|$)/.exec(document.cookie);return null===t?-1:parseInt(t[1],10)}();if(-1===t)return null;const n=yield fetch(`http://lisge.com/ib/k/now/r${t}.html`),e=yield n.text(),o=c(e,r).find("div.CIMGNM2");if(console.log(o),0===o.length)return null;const a=o.text().split(" / ")[0];return parseInt(a,10)}))}(),null!==i&&(s=i,n.closest("span.P2").after(` <span class="R2">[体調：${s}]</span>`)))}))}]);